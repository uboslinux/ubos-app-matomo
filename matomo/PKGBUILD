developer=https://matomo.org/
url=${developer}
maintainer=http://indiecomputing.com/
pkgname=$(basename $(pwd))
pkgver=5.0.3
pkgrel=1
pkgdesc="Analytics platform"
arch=('any')
license=("GPL3")
source=("https://builds.piwik.org/matomo-${pkgver}.tar.gz")
releasepage=("https://builds.piwik.org/LATEST")
depends=(
    'php'
)
options=('!strip')
sha512sums=('27974b81d07536dc73dd3327e78bf354d57391fb80dbc40c0c5679baf7ae0ec36829532b320657d6c5faecfcca11775370fec00bf2ac7a73f60cf6ad32f98329')

package() {
# Manifest
    install -D -m644 ${startdir}/ubos-manifest.json ${pkgdir}/ubos/lib/ubos/manifests/${pkgname}.json

# Icons
   install -D -m644 ${startdir}/appicons/{72x72,144x144}.png -t ${pkgdir}/ubos/http/_appicons/${pkgname}/

# Code
   install -D -m755 ${startdir}/bin/*.pl -t ${pkgdir}/ubos/share/${pkgname}/bin/

# Templates
   install -D -m644 ${startdir}/tmpl/*.tmpl -t ${pkgdir}/ubos/share/${pkgname}/tmpl/

# Systemd
   install -D -m644 ${startdir}/systemd/* -t ${pkgdir}/usr/lib/systemd/system/

# Data
    mkdir -p ${pkgdir}/ubos/lib/${pkgname}

# Cache
    mkdir -p ${pkgdir}/var/cache

# Source
    mkdir -p ${pkgdir}/ubos/share/${pkgname}
    cp -a ${startdir}/src/matomo/* ${pkgdir}/ubos/share/${pkgname}

# Cache
#    mkdir -p ${pkgdir}/var/cache/${pkgname}
}
