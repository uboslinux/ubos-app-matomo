developer=https://matomo.org/
url=${developer}
maintainer=http://indiecomputing.com/
pkgname=$(basename $(pwd))
pkgver=3.14.0
pkgrel=1
pkgdesc="Analytics platform"
arch=('any')
license=("GPL3")
source=("https://builds.piwik.org/matomo-${pkgver}.tar.gz")
releasepage=("https://builds.piwik.org/LATEST")
depends=(
    'php'
)
options=('!strip')
sha512sums=('5f71a3d5e86017f6324c7ecfa90c3b9f5c24a2af1856e199e468d52ed89b1a15f65fed03ab1b4887f62f5eb681e8bf9820cbf2b26ba2de4082171a760e9a9be5')

package() {
# Manifest
    install -D -m644 ${startdir}/ubos-manifest.json ${pkgdir}/ubos/lib/ubos/manifests/${pkgname}.json

# Icons
   install -D -m644 ${startdir}/appicons/{72x72,144x144}.png -t ${pkgdir}/ubos/http/_appicons/${pkgname}/

# Code
   install -D -m755 ${startdir}/bin/*.pl -t ${pkgdir}/ubos/share/${pkgname}/bin/

# Templates
   install -D -m644 ${startdir}/tmpl/*.tmpl -t ${pkgdir}/ubos/share/${pkgname}/tmpl/

# Systemd
   install -D -m644 ${startdir}/systemd/* -t ${pkgdir}/usr/lib/systemd/system/

# Data
    mkdir -p ${pkgdir}/ubos/lib/${pkgname}

# Cache
    mkdir -p ${pkgdir}/var/cache

# Source
    mkdir -p ${pkgdir}/ubos/share/${pkgname}
    cp -a ${startdir}/src/matomo/* ${pkgdir}/ubos/share/${pkgname}

# Cache
#    mkdir -p ${pkgdir}/var/cache/${pkgname}
}
